openapi: 3.0.0
info:
  title: simple-vault-auditor
  version: 1.0.0
  description: |
    Scan Vault paths for old static secrets
    
    ⚠️ EXPERIMENTAL CODE - NO WARRANTY
    Auto-generated by wxo-skill-compiler

servers:
  - url: http://localhost:8000
    description: Local development
  - url: https://{{server}}/api
    description: Production deployment

paths:
  /scan-vault-path:
    post:
      operationId: scan_vault_path
      requestBody:
        content:
          application/json:
            schema:
              properties:
                min_age_days:
                  description: Minimum age in days to flag as risk
                  type: integer
                vault_path:
                  description: Vault path to scan (e.g., secret/data/prod)
                  type: string
              required:
              - vault_path
              type: object
        required: true
      responses:
        '200':
          content:
            application/json:
              schema:
                properties:
                  findings:
                    items:
                      type: object
                    type: array
                  old_secrets_count:
                    type: integer
                  total_secrets:
                    type: integer
                type: object
          description: Success
      summary: Scan Vault path for static secrets older than threshold


components:
  schemas: {}
